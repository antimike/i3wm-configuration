#!/bin/sh

# Event handler for inputplug

event="$1"
device="$2"
use="$3"
name="$4"

# Load the given keymap
xkb() {
    xkbcomp -i ${device} -w 0 -I$HOME/.config/awesome/xkb \
        $HOME/.config/awesome/xkb/$1.xkb ${DISPLAY}
}

printf "input-event: $use: [%3d] $event $name\n" $device

case "$event,$use,$(uname -n),$name" in
    XIDeviceDisabled,XISlaveKeyboard,zoro,"Topre Corporation Realforce 87")
        # Getting undocked
        undock
        ;;
    XIDeviceDisabled,*)
        :
        ;;
    *,XISlaveKeyboard,zoro,"Topre Corporation Realforce 87")
        #  Are we getting docked?
        sleep 2
        dock
        xkb default
        ;;
    *,XISlaveKeyboard,zoro,"AT Translated Set 2 keyboard")
        xkb x1
        ;;
    *,XISlaveKeyboard,*,"ThinkPad Extra Buttons")
        xkb thinkpad-extra
        ;;
    *,XISlaveKeyboard,*)
        xkb default
        ;;
    *,XISlavePointer,*,"Microsoft Microsoft 3-Button Mouse with IntelliEye(TM)")
        xinput set-ptr-feedback $device 3 3 1
        ;;
    *,XISlavePointer,*,"TPPS/2 IBM TrackPoint")
        :
        # xinput set-ptr-feedback $device 2 5 1 # no effect?
        # xinput set-float-prop $device 'libinput Accel Speed' 0.5
        ;;
    *,XISlavePointer,zoro,"SynPS/2 Synaptics TouchPad")
        xinput set-props $device "libinput Natural Scrolling Enabled" 1
        ;;
    *,XISlavePointer,zoro,"ELAN Touchscreen")
        xinput disable $device
        ;;
esac
